@using X.PagedList.Mvc.Core
@using X.PagedList.Mvc.Bootstrap4.Core
@inject UpackContext _db
@model X.PagedList.IPagedList<Application>


@{
    ViewBag.Title = "Список проблем";
    Layout = "_Layout";
    
}

@{
  if (Model.Count != 0)
  {
    <div class="text-center col col-sm-3 col-md-4 col-lg-12">
      <table class="table table-hover">
        <thead class="table-secondary">
        <tr>
          <th scope="col" class="font">Менеджер</th>
          <th scope="col" class="font">Дата создания</th>
          <th scope="col" class="font">Ожидается</th>
          <th scope="col" class="font">Код клиента</th>
          <th scope="col" class="font">Клиент</th>
          <th scope="col" class="font">Артикул</th>
          <th scope="col" class="font">Кол-во</th>
          <th scope="col" class="font">Цена</th>
          <th scope="col" class="font">Сумма</th>
          <th scope="col" class="font">Комментарий</th>
          <th scope="col" class="font">Действия</th>
        </tr>
        </thead>
        <tbody>
        @{ 
          foreach (var appl in Model)
          {
            <tr>
              <td class="font text-dark">@appl.Manager.Surname @appl.Manager.Name</td>
              <td class="font text-dark">@appl.CreateDate.ToShortDateString()</td>
              <td class="font text-danger">
                @if (appl.WaitingDate != new DateTime(0001, 01, 01))
                {
                  @appl.WaitingDate.ToShortDateString()
                }
                else
                {
                  @:Дата не указана
                }
              </td>
              <td class="font text-dark">@appl.Client.CodeClient</td>
              <td class="font text-dark">@appl.Client.Title</td>
              <td class="font text-dark">@appl.ArticleNumber</td>
              <td class="font text-dark">@appl.Quantity</td>
              <td class="font text-dark">@appl.Price</td>
              <td class="font text-dark">@appl.Amount</td>
              <td class="font text-dark">@appl.Comment</td>
              <td>
                <div class="btn-group btn-group-sm shadow" role="group" aria-label="Button group with nested dropdown">
                  <button type="button" class="btn btn-success" title="Ответить">Ответить</button>
                  <a class="btn btn-sm btn-warning pt-2" title="Редактировать" asp-route-id="@appl.Id" asp-action="Edit" asp-controller="Applications"><i class="bi bi-pencil-square"></i></a>
                  <a class="btn btn-sm btn-danger pt-2" title="Удалить" asp-route-id="@appl.Id" asp-action="ConfirmDelete" asp-controller="Applications"><i class="bi bi-trash"></i></a>
                </div>
              </td>
            </tr>
          }
        }
        </tbody>
      </table>
    </div>
    
    
    <p class="text-center">Страница @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) из @Model.PageCount всего обращений @_db.Applications.Count()</p>
    <div class="row justify-content-center col-md-6 col-lg-6">
      @Html.PagedListPager(Model, page => Url.Action("Index", "Applications", new { page }), Bootstrap4PagedListRenderOptions.Default)
    </div>
    
  }
  else{<h3>Обращений не поступило, добавьте новые обращения</h3>}
}

@section Scripts
{
  <script >
    $(document).ready(function () {
        $('#caption').text("Список обращений");
    });
 </script>
}

